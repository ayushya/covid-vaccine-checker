(this["webpackJsonpvaccine-availability-checker"]=this["webpackJsonpvaccine-availability-checker"]||[]).push([[0],{115:function(e,t,a){"use strict";a.r(t);a(78);var n=a(0),c=a.n(n),l=a(9),r=a.n(l),i=a(11),o=a(14),s=(a(83),a(84),a(31)),u=a(46),d=a.n(u),f=a(155),b=a(13),j=a(33),v=a.n(j),m=a(47),h=a(39),O=a.n(h),S=a(148),g=a(157),p=a(160),E=a(153),x=a(154),T=a(151),_=a(158),C=a(159),A=a(156),y=a(16),I=a(51),D=a(67),R=a.n(D),w=a(13),F=w.GET_CENTERS_BY_DISTRICT,G=w.REFRESH_INTERVAL,N=function(){var e=Object(m.a)(v.a.mark((function e(t,a){var n,c,l,r,i,o;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=[],c=0;c<t.length;c++)for(l=0;l<4*a;l++)r=O.a.get("".concat(F),{params:{district_id:t[c],date:d()().add(7*l,"days").format("DD-MM-YYYY")}}).then((function(e){return e.data.centers})).catch((function(e){return console.log(e),setTimeout((function(){window.location.reload()}),1e3*G),[]})),n.push(r);return e.next=4,Promise.all(n);case 4:return i=e.sent,o=i.reduce((function(e,t){return[].concat(Object(I.a)(e),Object(I.a)(t))}),[]),e.abrupt("return",L(o));case 7:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),L=function(e){var t=new Set,a=new Set,n=k(e).map((function(e,n){var c={all:{any_total:0}};return e.sessions.forEach((function(e){var n,l,r,o,s,u,d,f=e.min_age_limit,b=e.available_capacity,j=e.vaccine;t.add(j),a.add(f),c=Object(i.a)(Object(i.a)({},c),{},(d={},Object(y.a)(d,f,Object(i.a)(Object(i.a)({},c[f]),{},(r={},Object(y.a)(r,j,Object(i.a)(Object(i.a)({},null===(n=c[f])||void 0===n?void 0:n[j]),{},Object(y.a)({},e.date,b))),Object(y.a)(r,"any",Object(i.a)(Object(i.a)({},null===(l=c[f])||void 0===l?void 0:l.any),{},Object(y.a)({},e.date,b))),r))),Object(y.a)(d,"all",Object(i.a)(Object(i.a)({},c.all),{},(u={},Object(y.a)(u,j,Object(i.a)(Object(i.a)({},null===(o=c.all)||void 0===o?void 0:o[j]),{},Object(y.a)({},e.date,b))),Object(y.a)(u,"any",Object(i.a)(Object(i.a)({},null===(s=c.all)||void 0===s?void 0:s.any),{},Object(y.a)({},e.date,b))),u))),d));var v="".concat(j,"_total");c[f][v]=c[f][v]?c[f][v]+b:b,c[f].any_total=c[f].any_total?c[f].any_total+b:b,c.all[v]=c.all[v]?c.all[v]+b:b,c.all.any_total+=b})),e.availability=c,e}));return[e,t,a,n]},k=function(e){var t={},a=[];return e.forEach((function(e,n){var c=t[e.center_id];if(void 0===c)a.push(e),t[e.center_id]=a.length-1;else{var l=a[c];a[c]=R()(l,e)}})),a};var U=a(5),V=Object(S.a)((function(e){return{formControl:{margin:e.spacing(1),minWidth:120},selectEmpty:{marginTop:e.spacing(2)}}})),M=function(e){var t,a,l=V(),r=e.states,i=e.setStates,s=e.stateSelected,u=e.setStateSelected,d=e.districts,f=e.setDistricts,j=e.districtsSelected,h=e.setDistrictsSelected,S=e.setRawCenters,y=e.centers,I=e.setCenters,D=e.vaccines,R=e.setVaccines,w=e.vaccineSelected,F=e.setVaccineSelected,G=e.ageGroup,L=e.setAgeGroup,k=e.ageGroupSelected,M=e.setAgeGroupSelected,Y=e.durationSelected,B=e.setDurationSelected,P=e.gridApi,J=e.setFilterDataModel,W=c.a.useState(b.REFRESH_INTERVAL),H=Object(o.a)(W,2),q=H[0],z=H[1];Object(n.useEffect)((function(){O.a.get(b.GET_STATES).then((function(e){i(e.data.states)})),j.length&&(K(s),Q())}),[]),function(e,t){var a=Object(n.useRef)();Object(n.useEffect)((function(){a.current=e}),[e]),Object(n.useEffect)((function(){if(null!==t){var e=setInterval((function(){a.current()}),t);return function(){return clearInterval(e)}}}),[t])}((function(){var e=q-1;0===e&&j.length&&Q(),e>=0&&z(e)}),1e3);var X=function(){var e=(null===P||void 0===P?void 0:P.getFilterModel())||{};J(e)},$=function(e){X(),S(null),I(null),e&&(R(null),F(b.DEFAULT_VACCINE),L(null),M(b.DEFAULT_AGE))},K=function(e){O.a.get("".concat(b.GET_DISTRICTS,"/").concat(e)).then((function(e){f(e.data.districts)}))},Q=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:j,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Y;$(e),new Promise(function(){var e=Object(m.a)(v.a.mark((function e(n){var c,l,r,i,s,u;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N(t,a);case 2:c=e.sent,l=Object(o.a)(c,4),r=l[0],i=l[1],s=l[2],u=l[3],S(r),I(u),R(i),L(s),z(b.REFRESH_INTERVAL),n();case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},Z=function(e){switch(e){case 18:return"18-44";case 45:return"45+";default:return e}};return Object(U.jsxs)("div",{style:{display:"flex",overflowX:"auto"},children:[Object(U.jsxs)(T.a,{variant:"outlined",className:l.formControl,children:[Object(U.jsx)(_.a,{id:"demo-simple-select-outlined-label",children:"States"}),Object(U.jsxs)(A.a,{labelId:"demo-simple-select-outlined-label",id:"demo-simple-select-outlined",value:s,onChange:function(e){var t=e.target.value;u(t),f(null),h([]),$(!0),K(t)},label:"State",children:[Object(U.jsx)(C.a,{value:"",children:Object(U.jsx)("em",{children:"None"})}),null===r||void 0===r?void 0:r.map((function(e,t){var a=e.state_id,n=e.state_name;return Object(U.jsx)(C.a,{value:a,children:n},t)}))]})]}),d?Object(U.jsxs)(T.a,{variant:"outlined",className:l.formControl,children:[Object(U.jsx)(_.a,{id:"demo-simple-select-outlined-label",children:"Districts"}),Object(U.jsx)(A.a,{labelId:"demo-simple-select-outlined-label",multiple:!0,id:"demo-simple-select-outlined",value:j,onChange:function(e){var t=e.target.value;h(t),Q(!0,t,Y)},label:"Districts",renderValue:function(e){return d.reduce((function(t,a){return e.some((function(e){return a.district_id===e}))?"".concat(t,", ").concat(a.district_name):t}),"").slice(1)},children:null===d||void 0===d?void 0:d.map((function(e,t){var a=e.district_id,n=e.district_name;return Object(U.jsxs)(C.a,{value:a,children:[Object(U.jsx)(g.a,{checked:j.indexOf(a)>-1}),Object(U.jsx)(p.a,{primary:n})]},t)}))})]}):null,D?Object(U.jsxs)(T.a,{variant:"outlined",className:l.formControl,children:[Object(U.jsx)(_.a,{id:"demo-simple-select-outlined-label",children:"Vaccines"}),Object(U.jsxs)(A.a,{labelId:"demo-simple-select-outlined-label",id:"demo-simple-select-outlined",value:w,onChange:function(e){X();var t=e.target.value;F(t);var a=y;I(null),setTimeout((function(){I(a)}),0)},label:"Vaccines",children:[Object(U.jsx)(C.a,{value:b.DEFAULT_VACCINE,children:Object(U.jsx)("em",{children:"Any"})}),null===(t=Array.from(D))||void 0===t?void 0:t.map((function(e,t){return Object(U.jsx)(C.a,{value:e,children:e},t)}))]})]}):null,G?Object(U.jsxs)(T.a,{variant:"outlined",className:l.formControl,children:[Object(U.jsx)(_.a,{id:"demo-simple-select-outlined-label",children:"Age Group"}),Object(U.jsxs)(A.a,{labelId:"demo-simple-select-outlined-label",id:"demo-simple-select-outlined",value:k,onChange:function(e){X();var t=e.target.value;M(t);var a=y;I(null),setTimeout((function(){I(a)}),0)},label:"Age Group",children:[Object(U.jsx)(C.a,{value:b.DEFAULT_AGE,children:Object(U.jsx)("em",{children:"All"})}),null===(a=Array.from(G))||void 0===a?void 0:a.map((function(e,t){return Object(U.jsx)(C.a,{value:e,children:Z(e)},t)}))]})]}):null,D&&G?Object(U.jsxs)(U.Fragment,{children:[Object(U.jsxs)(T.a,{variant:"outlined",className:l.formControl,children:[Object(U.jsx)(_.a,{id:"demo-simple-select-outlined-label",children:"Duration"}),Object(U.jsxs)(A.a,{labelId:"demo-simple-select-outlined-label",id:"demo-simple-select-outlined",value:Y,onChange:function(e){var t=e.target.value;B(t),Q(!1,j,t)},label:"Duration",children:[Object(U.jsx)(C.a,{value:"1",children:"1 Month"}),Object(U.jsx)(C.a,{value:"2",children:"2 Month"})]})]}),Object(U.jsxs)(E.a,{variant:"outlined",color:"primary",onClick:function(){z(0),Q()},style:{margin:"8px",height:"56px",minWidth:"152px"},children:[Object(U.jsx)(x.a,{children:"cached"}),Object(U.jsxs)("div",{children:["\xa0 ",function(){switch(q){case 0:return"Refreshing";default:return"in ".concat(q," s")}}()]})]})]}):null]})},Y=function(){var e=c.a.useState(null),t=Object(o.a)(e,2),a=t[0],l=t[1],r=c.a.useState(localStorage.getItem("stateSelected")||b.DEFAULT_STATE),u=Object(o.a)(r,2),j=u[0],v=u[1],m=c.a.useState(null),h=Object(o.a)(m,2),O=h[0],S=h[1],g=c.a.useState(JSON.parse(localStorage.getItem("districtsSelected"))||b.DEFAULT_DISTRICTS_SELECTED),p=Object(o.a)(g,2),E=p[0],x=p[1],T=c.a.useState(null),_=Object(o.a)(T,2),C=_[0],A=_[1],y=c.a.useState(null),I=Object(o.a)(y,2),D=I[0],R=I[1],w=c.a.useState(null),F=Object(o.a)(w,2),G=F[0],N=F[1],L=c.a.useState(localStorage.getItem("vaccineSelected")||b.DEFAULT_VACCINE),k=Object(o.a)(L,2),V=k[0],Y=k[1],B=c.a.useState(null),P=Object(o.a)(B,2),J=P[0],W=P[1],H=c.a.useState(localStorage.getItem("ageGroupSelected")||b.DEFAULT_AGE),q=Object(o.a)(H,2),z=q[0],X=q[1],$=c.a.useState(localStorage.getItem("durationSelected")||b.DEFAULT_DURATION),K=Object(o.a)($,2),Q=K[0],Z=K[1],ee=c.a.useState(null),te=Object(o.a)(ee,2),ae=te[0],ne=te[1],ce=c.a.useState(JSON.parse(localStorage.getItem("filterDataModel"))||{}),le=Object(o.a)(ce,2),re=le[0],ie=le[1],oe={states:a,setStates:l,stateSelected:j,setStateSelected:v,districts:O,setDistricts:S,districtsSelected:E,setDistrictsSelected:x,rawCenters:C,setRawCenters:A,centers:D,setCenters:R,vaccines:G,setVaccines:N,vaccineSelected:V,setVaccineSelected:Y,ageGroup:J,setAgeGroup:W,ageGroupSelected:z,setAgeGroupSelected:X,durationSelected:Q,setDurationSelected:Z,gridApi:ae,setGridApi:ne,filterDataModel:re,setFilterDataModel:ie};Object(n.useEffect)((function(){localStorage.setItem("stateSelected",j),localStorage.setItem("districtsSelected",JSON.stringify(E)),localStorage.setItem("vaccineSelected",V),localStorage.setItem("ageGroupSelected",z),localStorage.setItem("durationSelected",Q),localStorage.setItem("filterDataModel",JSON.stringify(re)),setTimeout((function(){null===ae||void 0===ae||ae.setFilterModel(re)}),0)}),[j,E,V,z,Q,ae]);var se=Array.apply(null,new Array(28*parseInt(Q))).map((function(e,t){return d()().add(t,"days").format("DD-MM-YYYY")})),ue=function(e){var t=e.value;switch(t){case void 0:return"NA";case 0:return"Booked";default:return"<a href=".concat(b.VACCINE_REGISTRATION_URL,' target="_blank" style="color:#fff; text-decoration: none"}>').concat(t,"</a>")}},de=function(e){var t={display:"flex",justifyContent:"center",fontWeight:"700",border:"1px solid rgb(186, 191, 199)"};switch(e.value){case void 0:return Object(i.a)({color:"rgba(0, 0, 0, 0.87)",backgroundColor:"#e0e0e0"},t);case 0:return Object(i.a)({color:"#fff",backgroundColor:"rgb(220, 0, 78)"},t);default:return Object(i.a)({color:"#fff",backgroundColor:"#2ecc71",cursor:"pointer"},t)}};return Object(U.jsxs)("div",{children:[Object(U.jsx)(M,Object(i.a)({},oe)),(null===D||void 0===D?void 0:D.length)?Object(U.jsx)("div",{className:"ag-theme-alpine",style:{height:"calc(100vh - 72px)",width:"100%"},children:Object(U.jsxs)(s.AgGridReact,{defaultColDef:{width:120,floatingFilter:!0,resizable:!0,suppressMovable:!0},enableCellTextSelection:!0,defaultColGroupDef:{marryChildren:!0},animateRows:!0,isExternalFilterPresent:function(){return!0},doesExternalFilterPass:function(e){var t;return void 0!==(null===(t=e.data.availability[z])||void 0===t?void 0:t["".concat(V,"_total")])},onGridReady:function(e){ne(e.api)},tooltipShowDelay:0,rowData:D,children:[Object(U.jsx)(s.AgGridColumn,{field:"pincode",sortable:!0,filter:!0}),Object(U.jsx)(s.AgGridColumn,{field:"name",tooltipField:"name",sortable:!0,filter:!0,width:200}),Object(U.jsx)(s.AgGridColumn,{headerName:"Fee",field:"fee_type",valueGetter:function(e){var t=e.data,a=t.fee_type,n=t.vaccine_fees;return(null===n||void 0===n?void 0:n[0].fee)||a},valueFormatter:function(e){var t=e.data,a=t.fee_type,n=t.vaccine_fees;return n?"\u20b9 ".concat(null===n||void 0===n?void 0:n[0].fee):a},sortable:!0,filter:!0,cellStyle:function(e){var t={display:"flex",justifyContent:"center",fontWeight:"700",border:"1px solid rgb(186, 191, 199)"};switch(e.value){case"Free":return Object(i.a)({color:"#fff",backgroundColor:"#2196f3"},t);default:return Object(i.a)({color:"#fff",backgroundColor:"#ff9800"},t)}}}),Object(U.jsx)(s.AgGridColumn,{headerName:"# Total",field:"availability.".concat(z,".").concat(V,"_total"),sortable:!0,filter:!1,width:120,cellStyle:de,sort:"desc",cellRenderer:ue}),null===se||void 0===se?void 0:se.map((function(e,t){return Object(U.jsx)(s.AgGridColumn,{headerName:e,field:"availability.".concat(z,".").concat(V,".").concat(e),sortable:!0,filter:!1,width:130,cellStyle:de,cellRenderer:ue,onCellClicked:function(e){var t,a=e.event;e.value>0&&(null===(t=a.target.querySelector("a"))||void 0===t||t.click())}},t)}))]})}):E.length?Object(U.jsx)("div",{style:{height:"calc(100vh - 72px)",width:"100%",display:"flex",justifyContent:"center"},children:Object(U.jsx)(f.a,{style:{alignSelf:"center"}})}):null]})},B=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,162)).then((function(t){var a=t.getCLS,n=t.getFID,c=t.getFCP,l=t.getLCP,r=t.getTTFB;a(e),n(e),c(e),l(e),r(e)}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(Object(U.jsx)(c.a.StrictMode,{children:Object(U.jsx)(Y,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)})),B()},13:function(e,t,a){"use strict";a.r(t),a.d(t,"VACCINE_REGISTRATION_URL",(function(){return n})),a.d(t,"SERVER_API_URL",(function(){return c})),a.d(t,"GET_STATES",(function(){return l})),a.d(t,"GET_DISTRICTS",(function(){return r})),a.d(t,"GET_CENTERS_BY_DISTRICT",(function(){return i})),a.d(t,"DEFAULT_STATE",(function(){return o})),a.d(t,"DEFAULT_DISTRICTS_SELECTED",(function(){return s})),a.d(t,"DEFAULT_VACCINE",(function(){return u})),a.d(t,"DEFAULT_AGE",(function(){return d})),a.d(t,"DEFAULT_DURATION",(function(){return f})),a.d(t,"REFRESH_INTERVAL",(function(){return b}));var n="https://selfregistration.cowin.gov.in/",c="https://cdn-api.co-vin.in/api/v2",l="".concat(c,"/admin/location/states"),r="".concat(c,"/admin/location/districts"),i="".concat(c,"/appointment/sessions/public/calendarByDistrict"),o="16",s=[294,265,276],u="any",d="all",f=1,b=300},78:function(e,t,a){}},[[115,1,2]]]);
//# sourceMappingURL=main.65edc38b.chunk.js.map